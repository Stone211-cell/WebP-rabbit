:root{
  --bg:#f0f4f8;--bg2:#ffffff;--bg3:#eef2f7;
  --navy:#1e3a5f;--blue:#2563eb;--blue2:#3b82f6;--blueLight:#dbeafe;--bluePale:#eff6ff;
  --teal:#0891b2;--tealLight:#cffafe;
  --red:#dc2626;--redLight:#fee2e2;
  --amber:#d97706;--amberLight:#fef3c7;
  --green:#16a34a;--greenLight:#dcfce7;
  --purple:#7c3aed;--purpleLight:#ede9fe;
  --t:#1e293b;--t2:#64748b;--t3:#94a3b8;--brd:#e2e8f0;
  --shadow:0 1px 3px rgba(0,0,0,.07);--shadow2:0 4px 14px rgba(0,0,0,.1);
}

body.dark{
  --bg:#0f172a;--bg2:#1e293b;--bg3:#334155;
  --t:#f1f5f9;--t2:#cbd5e1;--t3:#94a3b8;
  --brd:#475569;
  --navy:#e2e8f0;
  --shadow:0 1px 3px rgba(0,0,0,.3);--shadow2:0 4px 14px rgba(0,0,0,.5);
}

body.dark .header{background:#1e293b;}
body.dark .logo-text{color:#f1f5f9;}
body.dark .card{background:#1e293b;}
body.dark .chart-wrap{background:#1e293b;}
body.dark .modal .mbox{background:#1e293b;}
body.dark .fg input,body.dark .fg select,body.dark .fg textarea{background:#334155;color:#f1f5f9;border-color:#475569;}
body.dark table thead{background:#334155;}
body.dark tbody tr:hover{background:#334155;}
body.dark .cal{background:#1e293b;}
body.dark .cal-day{background:#334155;border-color:#475569;}
body.dark .cal-day:hover{background:#475569;}

*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--t);min-height:100vh;overflow-x:hidden;display:flex;}

.sidebar{width:240px;background:var(--bg2);border-right:1px solid var(--brd);position:fixed;left:0;top:0;height:100vh;display:flex;flex-direction:column;z-index:100;box-shadow:2px 0 8px rgba(0,0,0,.04);}
.sidebar-header{padding:20px;border-bottom:1px solid var(--brd);}
body.dark .sidebar{background:#1e293b;border-color:#334155;}
body.dark .sidebar-header{border-color:#334155;}
body.dark .sidebar-footer{border-color:#334155;}
body.dark .nav-tab{color:#94a3b8;}
body.dark .nav-tab:hover{background:#334155;color:#e0e7ff;}
body.dark .nav-tab.active{background:#3b82f6;color:#fff;}
body.dark .dark-toggle{background:#334155;border-color:#475569;color:#94a3b8;}
body.dark .dark-toggle:hover{border-color:#3b82f6;color:#e0e7ff;}

.main-content{margin-left:240px;flex:1;min-height:100vh;}

.header{background:var(--bg2);border-bottom:1px solid var(--brd);padding:16px 24px;position:sticky;top:0;z-index:50;box-shadow:var(--shadow);display:flex;align-items:center;justify-content:space-between;}
.logo{display:flex;align-items:center;gap:14px;padding:4px 0;}
.logo-icon{width:52px;height:52px;background:linear-gradient(135deg,#2563eb,#0891b2);border-radius:12px;display:flex;align-items:center;justify-content:center;}
.logo-icon svg{width:30px;height:30px;stroke:#fff;fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;}
.logo-text{font-size:1.35rem;font-weight:800;color:var(--navy);letter-spacing:-.02em;line-height:1.2;}
.logo-sub{font-size:.85rem;color:var(--t3);font-weight:500;margin-top:3px;}
.nav{display:flex;flex-direction:column;padding:12px 8px;flex:1;gap:4px;overflow-y:auto;}
.nav-tab{padding:12px 16px;border:none;background:transparent;color:var(--t2);font-family:'Inter',sans-serif;font-size:.82rem;font-weight:500;border-radius:8px;cursor:pointer;transition:all .15s;text-align:left;display:flex;align-items:center;gap:8px;}
.nav-tab:hover{background:var(--bluePale);color:var(--blue);}
.nav-tab.active{background:var(--blue);color:#fff;font-weight:600;box-shadow:0 2px 8px rgba(37,99,235,.3);}
.sidebar-footer{padding:12px;border-top:1px solid var(--brd);}
.dark-toggle{width:100%;padding:10px 16px;border:1px solid var(--brd);background:var(--bg3);border-radius:8px;cursor:pointer;font-size:.78rem;font-family:'Inter',sans-serif;transition:all .15s;display:flex;align-items:center;justify-content:center;gap:8px;color:var(--t2);font-weight:500;}
.dark-toggle:hover{border-color:var(--blue);color:var(--blue);}
.storage-status{margin-bottom:12px;padding:12px;background:var(--bg3);border:1px solid var(--brd);border-radius:8px;}
.storage-label{font-size:.7rem;color:var(--t3);text-transform:uppercase;letter-spacing:.05em;margin-bottom:6px;font-weight:600;}
.storage-bar{height:6px;background:var(--brd);border-radius:3px;overflow:hidden;margin-bottom:6px;}
.storage-fill{height:100%;background:linear-gradient(90deg,#10b981,#3b82f6);border-radius:3px;transition:width .3s,background .3s;}
.storage-fill.warning{background:linear-gradient(90deg,#f59e0b,#ef4444);}
.storage-text{font-size:.68rem;color:var(--t2);text-align:center;font-weight:500;}
body.dark .storage-status{background:#334155;border-color:#475569;}
.page-title{font-size:1.1rem;font-weight:700;color:var(--navy);}

.page{padding:22px 24px;max-width:1440px;margin:0 auto;width:100%;}

.cards-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(148px,1fr));gap:12px;margin-bottom:22px;}
.card{background:var(--bg2);border:1px solid var(--brd);border-radius:10px;padding:15px 16px;box-shadow:var(--shadow);position:relative;overflow:hidden;}
.card-accent{position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,#2563eb,#0891b2);}
.card.red .card-accent{background:#dc2626;}
.card.green .card-accent{background:#16a34a;}
.c-label{font-size:.68rem;color:var(--t2);font-weight:600;text-transform:uppercase;letter-spacing:.05em;}
.c-val{font-size:1.55rem;font-weight:700;color:var(--navy);margin-top:3px;}
.card.red .c-val{color:var(--red);}
.card.green .c-val{color:var(--green);}
.c-sub{font-size:.64rem;color:var(--t3);margin-top:2px;}

.sh{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;flex-wrap:wrap;gap:8px;}
.sh h2{font-size:.9rem;font-weight:600;color:var(--navy);}
.sh h2 span{color:var(--blue);}

.chart-wrap{background:var(--bg2);border:1px solid var(--brd);border-radius:12px;padding:22px 24px;box-shadow:var(--shadow);margin-bottom:22px;}
.chart-head{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:14px;flex-wrap:wrap;gap:8px;}
.chart-title{font-size:.84rem;font-weight:600;color:var(--navy);}
.chart-sub{font-size:.68rem;color:var(--t3);margin-top:2px;}
.chart-legend{display:flex;gap:14px;flex-wrap:wrap;}
.legend-item{display:flex;align-items:center;gap:6px;font-size:.71rem;color:var(--t2);font-weight:500;}
.legend-dot{width:10px;height:10px;border-radius:3px;}
.chart-canvas-wrap{width:100%;overflow-x:auto;}

.wnav{display:flex;align-items:center;gap:10px;justify-content:center;margin-bottom:18px;}
.wnav button{background:var(--bg2);border:1px solid var(--brd);color:var(--blue);padding:5px 14px;border-radius:6px;cursor:pointer;font-family:'Inter',sans-serif;font-size:.77rem;font-weight:600;transition:all .15s;}
.wnav button:hover{background:var(--bluePale);border-color:var(--blue2);}
.wnav span{font-size:.77rem;color:var(--t2);min-width:175px;text-align:center;font-weight:500;}

.ebar{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:14px;}

.fg-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(192px,1fr));gap:10px;}
.fg{display:flex;flex-direction:column;}
.fg label{font-size:.67rem;color:var(--t2);font-weight:600;text-transform:uppercase;letter-spacing:.04em;margin-bottom:5px;}
.fg input,.fg select,.fg textarea{background:var(--bg2);border:1px solid var(--brd);border-radius:6px;padding:8px 10px;color:var(--t);font-family:'Inter',sans-serif;font-size:.81rem;outline:none;transition:border-color .15s,box-shadow .15s;}
.fg input:focus,.fg select:focus,.fg textarea:focus{border-color:var(--blue);box-shadow:0 0 0 3px rgba(37,99,235,.1);}
.fg select{appearance:none;-webkit-appearance:none;cursor:pointer;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%2364748b'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 9px center;}
.fg textarea{resize:vertical;min-height:56px;}
.fg.full{grid-column:1/-1;}
.fg.span2{grid-column:span 2;}
.fg input[readonly]{background:var(--bg3);opacity:.6;cursor:default;}

.btn-row{display:flex;gap:8px;margin-top:16px;flex-wrap:wrap;}
.btn{padding:7px 18px;border:none;border-radius:6px;font-family:'Inter',sans-serif;font-weight:600;font-size:.77rem;cursor:pointer;transition:all .15s;white-space:nowrap;}
.btn-g{background:var(--blue);color:#fff;box-shadow:0 2px 6px rgba(37,99,235,.28);}
.btn-g:hover{background:#1d4ed8;transform:translateY(-1px);}
.btn-o{background:var(--bg2);border:1px solid var(--brd);color:var(--t2);}
.btn-o:hover{border-color:var(--blue);color:var(--blue);}

.twrap{overflow-x:auto;border-radius:8px;border:1px solid var(--brd);margin-top:10px;box-shadow:var(--shadow);}
table{width:100%;border-collapse:collapse;}
thead{background:var(--bg3);}
thead th{padding:8px 10px;text-align:left;font-size:.67rem;color:var(--t2);letter-spacing:.04em;text-transform:uppercase;font-weight:600;border-bottom:1px solid var(--brd);white-space:nowrap;}
tbody td{padding:7px 10px;font-size:.79rem;border-bottom:1px solid var(--brd);color:var(--t);}
tbody tr{transition:background .12s;}
tbody tr:hover{background:var(--bluePale);}
tbody tr.closed{opacity:.42;}
tbody tr.closed td.sname{text-decoration:line-through;color:var(--red);}

.badge{display:inline-block;padding:2px 7px;border-radius:4px;font-size:.65rem;font-weight:600;}
.b-new{background:var(--greenLight);color:var(--green);}
.b-old{background:var(--blueLight);color:#1d4ed8;}
.b-fol{background:var(--amberLight);color:var(--amber);}
.b-db{background:#f1f5f9;color:var(--t2);}
.b-cls{background:var(--redLight);color:var(--red);}
.b-opn{background:var(--greenLight);color:var(--green);}

.toast{position:fixed;bottom:24px;right:24px;background:var(--bg2);border:1px solid var(--brd);color:var(--navy);padding:10px 20px;border-radius:8px;font-size:.77rem;font-weight:600;box-shadow:var(--shadow2);transform:translateY(60px);opacity:0;transition:all .25s;z-index:9999;pointer-events:none;}
.toast.show{transform:translateY(0);opacity:1;}

@media(max-width:768px){
  .sidebar{width:70px;}
  .sidebar-header{padding:16px 8px;}
  .logo-text,.logo-sub{display:none;}
  .nav{padding:8px 4px;}
  .nav-tab{padding:12px 8px;justify-content:center;font-size:1.2rem;}
  .nav-tab span:last-child{display:none;}
  .dark-toggle span:last-child{display:none;}
  .dark-toggle{padding:10px 8px;}
  .main-content{margin-left:70px;}
  .page{padding:16px 14px;}
}

@media(max-width:600px){
  .fg-grid{grid-template-columns:1fr;}
  .fg.span2{grid-column:span 1;}
  .cards-row{grid-template-columns:repeat(2,1fr);}
}
